{"ast":null,"code":"import _objectSpread from\"C:/Users/User/speech-grammars/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{send,assign}from\"xstate\";// SRGS parser and example (logs the results to console on page load)\nimport{loadGrammar}from'./runparser';import{parse}from'./chartparser';import{grammar}from'./grammars/chores';const gram=loadGrammar(grammar);const input=\"Please turn the light off\";const prs=parse(input.split(/\\s+/),gram);const result=prs.resultsForRule(gram.$root)[0];console.log(result);function say(text){return send(_context=>({type:\"SPEAK\",value:text}));}function listen(){return send('LISTEN');}function parsing(text){return parse(text.split(/\\s+/),gram).resultsForRule(gram.$root)[0];}function promptAndAsk(prompt){return{initial:'prompt',states:{prompt:{entry:say(prompt),on:{ENDSPEECH:'ask'}},ask:{entry:listen()}}};}export const dmMachine={initial:'init',states:{init:{on:{CLICK:'welcome'}},welcome:_objectSpread({on:{RECOGNISED:[{cond:context=>parsing(context.recResult)!==undefined,target:\"returntheobject\",actions:assign(context=>{return{option:parsing(context.recResult)};})},{target:\".nomatch\"}]}},promptAndAsk(\"What do you want to do?\")),returnobject:{initial:\"prompt\",on:{ENDSPEECH:\"init\"},states:{prompt:{entry:send(context=>({type:\"SPEAK\",value:\"OK. the object is \".concat(context.option.homeappliances.object,\" and the action is \").concat(context.option.homeappliances.action,\".\")}))}}}}};","map":{"version":3,"sources":["C:/Users/User/speech-grammars/src/dmSmartHome.ts"],"names":["send","assign","loadGrammar","parse","grammar","gram","input","prs","split","result","resultsForRule","$root","console","log","say","text","_context","type","value","listen","parsing","promptAndAsk","prompt","initial","states","entry","on","ENDSPEECH","ask","dmMachine","init","CLICK","welcome","RECOGNISED","cond","context","recResult","undefined","target","actions","option","returnobject","homeappliances","object","action"],"mappings":"mJAAA,OAAwBA,IAAxB,CAAsCC,MAAtC,KAAoD,QAApD,CAEA;AACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,KAAT,KAAsB,eAAtB,CACA,OAASC,OAAT,KAAwB,mBAAxB,CAEA,KAAMC,CAAAA,IAAI,CAAGH,WAAW,CAACE,OAAD,CAAxB,CACA,KAAME,CAAAA,KAAK,CAAG,2BAAd,CACA,KAAMC,CAAAA,GAAG,CAAGJ,KAAK,CAACG,KAAK,CAACE,KAAN,CAAY,KAAZ,CAAD,CAAqBH,IAArB,CAAjB,CACA,KAAMI,CAAAA,MAAM,CAAGF,GAAG,CAACG,cAAJ,CAAmBL,IAAI,CAACM,KAAxB,EAA+B,CAA/B,CAAf,CACAC,OAAO,CAACC,GAAR,CAAYJ,MAAZ,EAEA,QAASK,CAAAA,GAAT,CAAaC,IAAb,CAAyD,CACrD,MAAOf,CAAAA,IAAI,CAAEgB,QAAD,GAA2B,CAAEC,IAAI,CAAE,OAAR,CAAiBC,KAAK,CAAEH,IAAxB,CAA3B,CAAD,CAAX,CACH,CAED,QAASI,CAAAA,MAAT,EAAgD,CAC5C,MAAOnB,CAAAA,IAAI,CAAC,QAAD,CAAX,CACH,CAED,QAASoB,CAAAA,OAAT,CAAiBL,IAAjB,CAAwE,CACpE,MAAQZ,CAAAA,KAAK,CAACY,IAAI,CAACP,KAAL,CAAW,KAAX,CAAD,CAAoBH,IAApB,CAAL,CAA+BK,cAA/B,CAA8CL,IAAI,CAACM,KAAnD,EAA0D,CAA1D,CAAR,CACH,CAED,QAASU,CAAAA,YAAT,CAAsBC,MAAtB,CAAgF,CAC5E,MAAQ,CACJC,OAAO,CAAE,QADL,CAEJC,MAAM,CAAE,CACJF,MAAM,CAAE,CACJG,KAAK,CAAEX,GAAG,CAACQ,MAAD,CADN,CAEJI,EAAE,CAAE,CAAEC,SAAS,CAAE,KAAb,CAFA,CADJ,CAKJC,GAAG,CAAE,CACDH,KAAK,CAAEN,MAAM,EADZ,CALD,CAFJ,CAAR,CAYH,CAGD,MAAO,MAAMU,CAAAA,SAAmD,CAAI,CAChEN,OAAO,CAAE,MADuD,CAEhEC,MAAM,CAAE,CACJM,IAAI,CAAE,CACFJ,EAAE,CAAE,CACAK,KAAK,CAAE,SADP,CADF,CADF,CAMJC,OAAO,gBACHN,EAAE,CAAE,CACAO,UAAU,CAAE,CAAC,CACTC,IAAI,CAAGC,OAAD,EAAaf,OAAO,CAACe,OAAO,CAACC,SAAT,CAAP,GAA+BC,SADzC,CAETC,MAAM,CAAE,iBAFC,CAGTC,OAAO,CAAEtC,MAAM,CAAEkC,OAAD,EAAa,CAAE,MAAO,CAAEK,MAAM,CAAEpB,OAAO,CAACe,OAAO,CAACC,SAAT,CAAjB,CAAP,CAA+C,CAA/D,CAHN,CAAD,CAKZ,CAACE,MAAM,CAAE,UAAT,CALY,CADZ,CADD,EASIjB,YAAY,CAAC,yBAAD,CAThB,CANH,CAiBJoB,YAAY,CAAE,CACVlB,OAAO,CAAE,QADC,CAEVG,EAAE,CAAE,CAAEC,SAAS,CAAE,MAAb,CAFM,CAGVH,MAAM,CAAE,CACJF,MAAM,CAAE,CACJG,KAAK,CAAEzB,IAAI,CAAEmC,OAAD,GAAc,CACtBlB,IAAI,CAAE,OADgB,CAEtBC,KAAK,6BAAuBiB,OAAO,CAACK,MAAR,CAAeE,cAAf,CAA8BC,MAArD,+BAAiFR,OAAO,CAACK,MAAR,CAAeE,cAAf,CAA8BE,MAA/G,KAFiB,CAAd,CAAD,CADP,CADJ,CAHE,CAjBV,CAFwD,CAA7D","sourcesContent":["import { MachineConfig, send, Action, assign } from \"xstate\";\n\n// SRGS parser and example (logs the results to console on page load)\nimport { loadGrammar } from './runparser'\nimport { parse } from './chartparser'\nimport { grammar } from './grammars/chores'\n\nconst gram = loadGrammar(grammar)\nconst input = \"Please turn the light off\"\nconst prs = parse(input.split(/\\s+/), gram)\nconst result = prs.resultsForRule(gram.$root)[0]\nconsole.log(result)\n\nfunction say(text: string): Action<SDSContext, SDSEvent> {\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\n}\n\nfunction listen(): Action<SDSContext, SDSEvent> {\n    return send('LISTEN')\n}\n\nfunction parsing(text:string): MachineConfig<SDSContext, any, SDSEvent> {\n    return (parse(text.split(/\\s+/), gram).resultsForRule(gram.$root)[0])\n}\n\nfunction promptAndAsk(prompt: string): MachineConfig<SDSContext, any, SDSEvent> {\n    return ({\n        initial: 'prompt',\n        states: {\n            prompt: {\n                entry: say(prompt),\n                on: { ENDSPEECH: 'ask' }\n            },\n            ask: {\n                entry: listen(),\n            },\n        }\n    })\n}\n\n\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'init',\n    states: {\n        init: {\n            on: {\n                CLICK: 'welcome'\n            }\n        },\n        welcome: {\n            on: {\n                RECOGNISED: [{\n                    cond: (context) => parsing(context.recResult) !== undefined,\n                    target: \"returntheobject\",\n                    actions: assign((context) => { return { option: parsing(context.recResult) } }),\n                },\n                {target: \".nomatch\" }]    \n            },\n                ...promptAndAsk(\"What do you want to do?\")\n        },\n        returnobject: {\n            initial: \"prompt\",\n            on: { ENDSPEECH: \"init\" },\n            states: {\n                prompt: {\n                    entry: send((context) => ({\n                        type: \"SPEAK\",\n                        value: `OK. the object is ${context.option.homeappliances.object} and the action is ${context.option.homeappliances.action}.`\n                    }))\n                },\n            }\n        },\n        \n    }\n})\n"]},"metadata":{},"sourceType":"module"}